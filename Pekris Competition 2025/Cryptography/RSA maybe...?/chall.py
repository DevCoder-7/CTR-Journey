from Crypto.Util.number import bytes_to_long, getPrime, inverse
from sympy import nextprime

flag = b'NETSOS{REDACTED}'
p = getPrime(256)
q = getPrime(256)
assert p > q
n = p * q
e = 0x10001
m = bytes_to_long(flag)
c = pow(m, e, n)

N = pow(p, 7) * q
phi = pow(p, 6) * (p - 1) * (q - 1)
d1 = getPrime(2000)
d2 = nextprime(d1 + getPrime(1000))
e1 = inverse(d1, phi)
e2 = inverse(d2, phi)

print(f'c = {c}')
print(f'N = {N}')
print(f'e1 = {e1}')
print(f'e2 = {e2}')

"""
c = 4682732069986929665485107123629807263317108560722037217292402821445486667653850979106937633482686062857055322327526299130398895602234089265154294288239322
N = 17131225034271829856804739152918127682134596501130178458170052329848464940322808830845716266334411253697035343705537131918307832852505466501932082805377925432659059223061460458755746143963686166239488478288282518288984709539048774843869981414613257204832055341452641877229332916166275920244398860729101910925334186492232235650238068307373252994502062301145669085174410187576582406670039198390456210048468520768423549947868037781892652056836298219469275753398182070329015279242835272699144185287030745837045160527179566107105060830295936418891862900884242162335716171022509432423597684070555771074648733552431454108439
e1 = 4662411273098549272660176329207341363425296846497816025649870225791197162414108151136598019312732015607945642255504928667755267632765246209075939360951721509370898613332400532567233640841393861634357791830382655518222531714379799564714088410334810779410362809259949939892190908798363631402453032179422151520473434912268932242757160104136999481351773703509703029347698151277511216509512958985586060382294295188038988252252040981580183785725062726015680323916647674261609686087242391199620046023893563380306375283054458951688276417885634240608722600439316962905826842028208623463285527423139409954406413392559652412251
e2 = 7464913082741388914841972483206363806307814442125173810343531267161002284746395034906625744222229872246391381592387867498303995976247601264833715969704813883332696048693302661224683997432178004572228676545535044747530658948606488078165117255814134691804533470838207018530873923341377707195563137387608794089124662692681596868226946345467847823308641375558350223180855236182159923074502351480149242677433134549736427336267077421578516252971959572923141196339907233053993081012296170735152704103593731870769475084367423945132443021304222783566644381200049356747310632642697860740669960928821435819043890726225294350767

"""
